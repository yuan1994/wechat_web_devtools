'use strict';var _exports;function init(){function a(q,r='alert'){f.showConfirm({content:q,type:r})}function b(q,r='success'){f.showTipsMsg({msg:q,type:r})}const c=require('../../lib/react.js'),d=require('../../cssStr/cssStr.js'),e=require('../../stores/windowStores.js'),f=require('../../actions/windowActions.js'),g=require('../../actions/webviewActions.js'),h=require('../../stores/projectStores.js'),i=require('../../config/dirConfig.js'),j=require('../../common/request/request.js'),k=require('../../common/log/log.js'),l=require('glob'),m=require('path'),n=require('fs'),{cleanUserAuth:o}=require('../../config/urlConfig.js'),p=c.createClass({displayName:'Cache',getInitialState:function(){return{show:!1}},clickOpen:function(){let q=this.state.show;this.setState({show:!q})},clearStorage:function(){let q=e.getUserInfo(),r=q?q.openid:'unknow',s=i.WeappStorage,t=this.props.project,u=t.appid,v=t.appname,w=m.join(s,`${u}_${v}_${r}.data.json`);n.unlink(w,x=>{b('\u6E05\u9664\u6570\u636E\u5B58\u50A8\u6210\u529F'),g.upASData(u,{})})},clearFileStorage:function(){let q=e.getUserInfo(),r=q?q.openid:'unknow',s=i.WeappFileCache,t=this.props.project,u=t.hash;l('*',{cwd:s},(v,w)=>{let x=`${u}_${r}`;w.forEach(y=>{if(-1<y.indexOf(x)){let z=m.join(s,y);n.unlink(z)}}),b('\u6E05\u9664\u6587\u4EF6\u5B58\u50A8\u6210\u529F')})},clearSdkUserAuthStorage:function(){h.setUserAuthPemissionStorage(this.props.project,{}),b('\u6E05\u9664\u6388\u6743\u6570\u636E\u6210\u529F')},clearCloudAuth:function(){j({method:'post',url:`${o}?appid=${this.props.project.appid}`,needToken:1},(q,r,s)=>{let t='\u6E05\u9664\u540E\u53F0\u6388\u6743\u6570\u636E\u5931\u8D25\uFF01';if(!!q)k.info(`cache.js clearSdkUserAuthStorage error: ${q.toString()}`);else if(s=JSON.parse(s),s.baseresponse){if(0==s.baseresponse.errcode)return void b('\u6E05\u9664\u6388\u6743\u6570\u636E\u6210\u529F');t=t+'errcode:'+s.baseresponse.errcode}a(t)})},render:function(){let q=this.state.show?d.displayBlock:d.displayNone;return c.createElement('div',{onClick:this.clickOpen,title:'\u6E05\u9664\u7F13\u5B58',className:'sidebar-item'},c.createElement('i',{className:'sidebar-item-icon sidebar-item-icon-cache'}),c.createElement('label',{className:'sidebar-item-label'},'\u7F13\u5B58'),c.createElement('div',{className:'cache-card',style:q},c.createElement('div',{className:'cache-card-item',onClick:this.clearStorage},c.createElement('p',null,'\u6E05\u9664\u6570\u636E\u5B58\u50A8')),c.createElement('div',{className:'cache-card-item',onClick:this.clearFileStorage},c.createElement('p',null,'\u6E05\u9664\u6587\u4EF6\u5B58\u50A8')),c.createElement('div',{className:'cache-card-item',onClick:this.clearSdkUserAuthStorage},c.createElement('p',null,'\u6E05\u9664\u5DE5\u5177\u6388\u6743\u6570\u636E')),c.createElement('div',{className:'cache-card-item',onClick:this.clearCloudAuth},c.createElement('p',null,'\u6E05\u9664\u624B\u673A\u6388\u6743\u6570\u636E'))))}});_exports=p}init(),module.exports=_exports;
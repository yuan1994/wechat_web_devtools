'use strict';var _exports;function init(){require('path'),require('fs');const a=require('../../lib/react.js'),b=require('../../cssStr/cssStr.js'),c=require('../../stores/webviewStores.js');require('../../stores/windowStores.js');const d=require('../../actions/leftviewActions.js');require('../../weapp/utils/tools.js'),require('../../common/log/log.js'),require('../../weapp/utils/projectManager.js');const e=a.createClass({displayName:'WebviewHeader',getInitialState:function(){let{project:f,appJSON:g,pageJSON:h}=this.props,i='';return f&&(i=h.navigationBarTitleText||g.window.navigationBarTitleText||''),{title:i,webviewID:parseInt(this.props.webviewID),canGoBack:!1,showRightBtn:!0,showBarLoading:!1}},_upWebviewStatus:function(f,g){0!==f&&(g.canGoBack=!0),Object.assign(this.state,g),this.setState(this.state)},_cleanWebview:function(){this.state.webviewID,this.setState({title:'',showRightBtn:!0,showBarLoading:!1})},_setInterfaceFromPageFrame:function(f){let g=f.name;'setNavigationBarTitle'===g?this.setState({title:f.value}):'showNavigationBarLoading'===g?this.setState({showBarLoading:!0}):'hideNavigationBarLoading'===g&&this.setState({showBarLoading:!1})},_setInterfaceRes:function(f,g,h,i){h&&('hideOptionMenu'===g||'hideMenuItems'===g||'hideAllNonBaseMenuItem'===g?this.setState({showRightBtn:!1}):('showOptionMenu'==g||'showMenuItems'==g||'showAllNonBaseMenuItem'==g)&&this.setState({showRightBtn:!0}))},componentDidMount:function(){let f=this.state.webviewID;c.on(`SET_INTERFACE_RES_${f}`,this._setInterfaceRes),c.on(`UP_WEBVIEW_STATUS_${f}`,this._upWebviewStatus),c.on(`CLEAN_WEBVIEW_${f}`,this._cleanWebview),c.on(`SET_INTERFACT_FROMPAGEFRAME_${f}`,this._setInterfaceFromPageFrame)},componentWillUnmount:function(){let f=this.state.webviewID;c.removeListener(`CLEAN_WEBVIEW_${f}`,this._cleanWebview),c.removeListener(`SET_INTERFACE_RES_${f}`,this._setInterfaceRes),c.removeListener(`UP_WEBVIEW_STATUS_${f}`,this._upWebviewStatus),c.removeListener(`SET_INTERFACT_FROMPAGEFRAME_${f}`,this._setInterfaceFromPageFrame)},handleRightClick:function(){d.clickRightHeader(this.state.webviewID)},goBack:function(f){this.props.goBack()},closeLocation:function(){this.goBack(),this.props.closeLocation()},chooseLocation:function(){this.goBack(),this.props.chooseLocation()},render:function(){let{offset:f,hideBack:g,webviewID:h,project:i,isMap:j,goBack:k,showFooter:l,pageJSON:m,appJSON:n}=this.props;if(this.props.isMap)return a.createElement('div',{style:{width:f.width},className:'simulator-hd'},a.createElement('div',{onClick:this.closeLocation,className:'simulator-hd-back'},a.createElement('span',null,'\u53D6\u6D88')),a.createElement('h3',{className:'simulator-hd-title'},'\u4F4D\u7F6E'),a.createElement('div',{onClick:this.chooseLocation,className:'simulator-hd-option'},'\u53D1\u9001'));let o={width:f.width,backgroundColor:m.navigationBarBackgroundColor||n.window.navigationBarBackgroundColor||'#000000'},p=!g&&this.state.canGoBack?{}:b.visibilityHidden;0==h&&i&&(p=b.visibilityHidden);let q={};this.props.project||!this.state.showRightBtn&&(q=b.visibilityHidden);let r={color:m.navigationBarTextStyle||n.window.navigationBarTextStyle||'white'},s=this.state.title||m.navigationBarTitleText||n.window.navigationBarTitleText,t=this.props.showRecordWording?'  \u5F55\u97F3\u4E2D...':'';return a.createElement('div',{style:o,className:'simulator-hd'},a.createElement('div',{onClick:this.goBack,style:p,className:'simulator-hd-back'},a.createElement('i',{className:'simulator-hd-back-icon'}),a.createElement('span',{style:r},'\u8FD4\u56DE')),a.createElement('h3',{className:'simulator-hd-title',style:r},this.state.showBarLoading?a.createElement('i',{className:'simulator-hd-title-loading'}):'',s,t),a.createElement('div',{style:q,onClick:l,className:'simulator-hd-option'},a.createElement('i',{className:'simulator-hd-option-icon'})))}});_exports=e}init(),module.exports=_exports;
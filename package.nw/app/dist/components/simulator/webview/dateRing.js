'use strict';var _exports;function init(){const a=require('../../../cssStr/cssStr.js'),b=require('../../../lib/react.js');require('../../../lib/react-dom.js');const c=require('./pickerRing'),d=b.createClass({displayName:'DateRing',getInitialState:function(){const e=[],f=[],g=[];for(let j=1;32>j;j++)13>j&&f.push(9<j?`${j}月`:`0${j}月`),g.push(9<j?`${j}日`:`0${j}日`);for(let j=1900;2100>=j;j++)e.push(`${j}年`);var h=new Date;return{yearArray:e,monthArray:f,dayArray:g,yearCurrent:h.getFullYear()-1900,monthCurrent:h.getMonth(),dayCurrent:h.getDate()-1}},componentDidMount:function(){this.range={},this.setRange('start',this.props.start||'1900-01-01'),this.setRange('end',this.props.end||'2100-01-01'),this.setCurrent(this.props.current)},componentWillReceiveProps:function(e){if(e.show){if(e.current!=this.props.current){let l=e.current||'';l=e.current.split('-');let m=parseInt(l[0])-1900,n=parseInt(l[1])-1,o=parseInt(l[2])-1,p=new Date;this.setState({yearCurrent:isNaN(m)?p.getFullYear()-1900:Math.min(Math.max(m,0),2100),monthCurrent:isNaN(n)?p.getMonth():Math.min(Math.max(n,0),11),dayCurrent:isNaN(o)?p.getDate()-1:Math.min(Math.max(o,0),30)})}e.start!=this.props.start&&this.setRange('start',e.start||'1900-01-01'),e.end!=this.props.end&&this.setRange('end',e.end||'2100-01-01')}},validDate:function(e,f,g){let h=new Date(`${e+1900}-${f+1}-${g+1}`),j=h.getDate()-1;return this.state.dayCurrent!=j&&(this.setState({dayCurrent:j}),this.refs.dayPicker.setCurrent(j)),h},setRange:function(e,f){if(f){let l=new Date(f);'Invalid Date'!=l&&(this.range[e]=l.getTime())}},setCurrent:function(e){if(e){let l=new Date(e);'Invalid Date'==l&&(l=new Date,l.getTime()<this.range.start?l=new Date(this.range.start):l.getTime()>this.range.end&&(l=new Date(this.range.end))),this.setState({yearCurrent:l.getFullYear()-1900,monthCurrent:l.getMonth(),dayCurrent:l.getDate()-1})}},onYearSelect:function(e){let f=e,g=this.validDate(f,this.state.monthCurrent,this.state.dayCurrent);g.getTime()<this.range.start?(f=new Date(this.range.start).getFullYear()-1900,this.refs.yearPicker.setCurrent(f)):g.getTime()>this.range.end&&(f=new Date(this.range.end).getFullYear()-1900,this.refs.yearPicker.setCurrent(f)),this.setState({yearCurrent:f})},onMonthSelect:function(e){let f=e,g=this.validDate(this.state.yearCurrent,f,this.state.dayCurrent);g.getTime()<this.range.start?(f=new Date(this.range.start).getMonth(),this.refs.monthPicker.setCurrent(f)):g.getTime()>this.range.end&&(f=new Date(this.range.end).getMonth(),this.refs.monthPicker.setCurrent(f)),this.setState({monthCurrent:f})},onDaySelect:function(e){let f=e,g=this.validDate(this.state.yearCurrent,this.state.monthCurrent,f);f=g.getDate()-1,g.getTime()<this.range.start?(f=new Date(this.range.start).getDate()-1,this.refs.dayPicker.setCurrent(f)):g.getTime()>this.range.end&&(f=new Date(this.range.end).getDate()-1,this.refs.dayPicker.setCurrent(f)),this.setState({dayCurrent:f})},getValue:function(){let e=this.state.yearCurrent+1900;if('month'===this.props.fields){let f=this.state.monthCurrent+1;f=9<f?f:'0'+f,e=e+'-'+f}else if('day'===this.props.fields){let f=this.state.monthCurrent+1;f=9<f?f:'0'+f;let g=this.state.dayCurrent+1;g=9<g?g:'0'+g,e=e+'-'+f+'-'+g}return e},render:function(){return b.createElement('div',{className:'wx-picker-bd',style:this.props.show?{}:a.displayNone},b.createElement(c,{ref:'yearPicker',array:this.state.yearArray,current:this.state.yearCurrent,onPickerSelect:this.onYearSelect}),b.createElement(c,{ref:'monthPicker',hidden:'year'==this.props.fields,array:this.state.monthArray,current:this.state.monthCurrent,onPickerSelect:this.onMonthSelect}),b.createElement(c,{ref:'dayPicker',hidden:'day'!=this.props.fields,array:this.state.dayArray,current:this.state.dayCurrent,onPickerSelect:this.onDaySelect}))}});_exports=d}init(),module.exports=_exports;
'use strict';var _exports;function init(){const a=require('../log/log.js'),b=require('../../config/urlConfig.js');require('../../config/errcodeConfig.js');const c=b.batchAddCardURL,d=b.chooseCardURL,e=b.batchViewCardURL;_exports={exec:(f,g,h,j)=>{const k=require('../request/request.js');let l=g.sdkName,m=g.args,n=m.appId;if('batchAddCard'===l){let o=m.card_list||[],p={},q=[];for(let s=0,t=o.length;s<t;s++){let u=o[s];p[u.card_id]?p[u.card_id]++:(q.push(u),p[u.card_id]=1)}let r={url:c,body:JSON.stringify({appid:n,getitem_list:q}),method:'post',needToken:1};a.info(`cardSdk.js batchAddCard begin ${JSON.stringify(r)}`),k(r,(s,t,u)=>{if(!s){a.info(`cardSdk.js batchAddCard get ${u}`);let v=JSON.parse(u),w=v.baseresponse,x=w.errcode;if(0===x){let y=v.json_ret_list.map(z=>{return z=JSON.parse(z),z.amount=p[z.card_tp_id],z});j(null,y)}else j(w,[])}else a.error(`cardSdk.js batchAddCard error ${JSON.stringify(s)}`),j(s)})}else if('chooseCard'===l){let o={appid:n,shop_id:m.location_id||0,sign_type:m.sign_type,card_sign:m.card_sign,time_stamp:m.time_stamp,nonce_str:m.nonce_str,card_tp_id:m.card_id,card_type:m.card_type},p={url:d,body:JSON.stringify(o),method:'post',needToken:1};a.info(`cardSdk.js chooseCard begin ${JSON.stringify(p)}`),k(p,(q,r,s)=>{if(!q){a.info(`cardSdk.js chooseCard get ${s}`);let t=JSON.parse(s),u=t.baseresponse;0===u.errcode?j(null,JSON.parse(t.json_ret)):j(u,[])}else a.error(`cardSdk.js chooseCard error ${JSON.stringify(q)}`),j(q)})}else if('batchViewCard'===l){m.card_list=m.card_list||[];let o=m.card_list.map(q=>{return{card_tp_id:q.card_id,code:q.code}}),p={url:e,body:JSON.stringify({appid:n,items:o}),method:'post',needToken:1};a.info(`cardSdk.js batchViewCard begin ${JSON.stringify(p)}`),k(p,(q,r,s)=>{if(!q){a.info(`cardSdk.js batchViewCard get ${s}`);let t=JSON.parse(s),u=t.baseresponse;if(0===u.errcode){let v=t.json_ret?JSON.parse(t.json_ret):{card_array:[]},w=t.error_json_ret_list.map(x=>{return JSON.parse(x)});j(null,{retData:v,errData:w})}else j(u,[])}else a.error(`cardSdk.js batchViewCard error ${JSON.stringify(q)}`),j(q)})}}}}init(),module.exports=_exports;
'use strict';var _exports;function init(){function a(h){let i=document.createElement('input');i.style.display='none',i.setAttribute('type','file'),h.accept&&i.setAttribute('accept',h.accept),h.multiple&&i.setAttribute('multiple','multiple'),global.contentDocumentBody.appendChild(i),i.addEventListener('change',j=>{h.sucCall&&h.sucCall(j),global.contentDocumentBody.removeChild(i)}),i.addEventListener('cancel',j=>{h.cancelCall&&h.cancelCall(j),global.contentDocumentBody.removeChild(i)}),i.click()}require('../../utils/tools.js');const b=require('../../stores/projectStores.js'),c=require('../../utils/file.js'),d=require('path');require('url');const e=require('../../lib/imagesize.js'),f=require('fs');require('../../common/request/request.js'),require('../../weapp/utils/tools.js');const g=require('../../actions/webviewActions.js');_exports={chooseVideo:function(i,j){i.args,a({accept:'video/*',sucCall:k=>{let l=b.getProjectByHash(i.apphash),m=k.target.value.split(';'),n=[];m.forEach(o=>{let p=d.extname(o);n.push(c.copyFileToTemp(o,l.hash,p))}),j({errMsg:'chooseVideo:ok',tempFilePath:n[0]})},cancelCall:()=>{j({errMsg:'chooseVideo:cancel'})}})},chooseImage:function(i,j){let k=i.args,l=Number.isInteger(k.count)&&9>=k.count&&1<=k.count?k.count:9;a({accept:'image/*',multiple:1<l,sucCall:m=>{let n=b.getProjectByHash(i.apphash),o=m.target.value.split(';');o=o.slice(0,l);let p=[];o.forEach(q=>{let r=d.extname(q);p.push(c.copyFileToTemp(q,n.hash,r))}),j({errMsg:'chooseImage:ok',tempFilePaths:p})},cancelCall:()=>{j({errMsg:'chooseImage:cancel'})}})},previewImage:function(i,j){g.sendASSDK('previewImage',i,j)},getImageInfo:function(i,j){let k=i.args.src,l=c.isAppTmpPath(k),m=b.getProjectByHash(i.apphash),n=l?c.getRealPath(k):d.join(m.projectpath,k);if(!f.existsSync(n))return void j({errMsg:'getImageInfo:fail file not exist'});let o=f.createReadStream(n);e(o,function(p,q){p?j({errMsg:`getImageInfo:fail ${p.toString()}`}):j({errMsg:'getImageInfo:ok',width:q.width,height:q.height})})}}}init(),module.exports=_exports;
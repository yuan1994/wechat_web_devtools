'use strict';var _exports;function init(){function a(f){let g=document.createElement('input');g.style.display='none',g.setAttribute('type','file'),g.setAttribute('accept','image/*'),global.contentDocumentBody.appendChild(g),g.addEventListener('change',h=>{f.sucCall&&f.sucCall(g.value),global.contentDocumentBody.removeChild(g)}),g.addEventListener('cancel',h=>{f.cancelCall&&f.cancelCall(h),global.contentDocumentBody.removeChild(g)}),g.click()}require('../../actions/webviewActions.js');const b=require('../request/request.js'),c=require('fs'),{jsDecodeQRCodeURL:d}=require('../../config/urlConfig.js');_exports={scanCode:function(g,h){let{appid:i,args:j}=g;a({sucCall:k=>{b({url:`${d}?appid=${i}`,method:'post',body:c.readFileSync(k),needToken:1},(l,m,n)=>{if(l)return void h({errMsg:`scanCode:fail ${JSON.stringify(l)}`});try{n=JSON.parse(n)}catch(o){return void h({errMsg:`scanCode:fail ${JSON.stringify(o)}`})}if(n.result||n.path){let o=n.path?decodeURIComponent(n.path):'';h({errMsg:'scanCode:ok',result:n.result,scanType:n.scan_type,path:o,charSet:n.char_set})}else h({errMsg:'scanCode:fail'})})},cancelCall:()=>{h({errMsg:'scanCode:cancel'})}})}}}init(),module.exports=_exports;
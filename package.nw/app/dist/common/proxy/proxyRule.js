'use strict';var _exports;function init(){function a(j){let k=j.headers.host,l=!j.connection.encrypted||/^http:/.test(j.url)?'http':'https',m='http'===l?j.url:l+'://'+k+j.url,n=b.parse(m);return n.pureHref=n.href.replace(/\?.*/,'').replace(/\#.*/,''),n}require('fs');const b=require('url'),c=require('path');require('zlib'),require('../../utils/report.js');const d=require('../../weapp/weApp.js'),e=require('../../config/config.js'),f='https://clients1.google.com/tbproxy/af/',g=e.weappURLRegular,h=e.weappASURLRegular,i=e.weappLocalIdRegular;_exports={shouldUseLocalResponse:function(j,k){let l=a(j),m=l.pureHref;if(g.test(m))return!0;return!(0!==m.indexOf(f))||!!h.test(m)||!!i.test(m)},dealLocalResponse:function(j,k,l){var m=a(j),n=m.pureHref;if(g.test(n)){let o=m.href;d.getResponse(o,(p,q,r)=>{return p?void l(p,q,r||''):void(c.extname(o).replace('.',''),l(200,q,r))})}else 0===n.indexOf(f)?(console.error(f),l(400,{},'')):h.test(n)?d.getAppservice(n,(o,p,q)=>{return o?void l(o,{},q):void l(200,p,q)}):i.test(n)&&d.getLocalIdResponse(n.replace(i,'wxfile://'),(o,p,q)=>{return o?void l(o,{},q):void l(200,p,q)})}}}init(),module.exports=_exports;
'use strict';var _exports;function init(){const a=require('events').EventEmitter,b=require('../common/log/log.js');require('../utils/tools.js');var c,d=0,e=JSON.parse(localStorage.getItem('userInfo'))||{},f={},g={},i,j=JSON.parse(localStorage.getItem('setting'))||{},k=j.proxyType||'SYSTEM';const l=Object.assign({},a.prototype,{showTipsMsg:function(m){this.emit('SHOW_TIPS_MSG',m)},getProxySetting:function(){return k},updataProxySetting:function(m,n){k=m,b.info(`windowStores.js updataProxySetting ${m}`);let o=require('../common/proxy/setAppProxy.js');o.up(()=>{n()})},getInitInfo:function(){return b.info(`windowStores.js getInitInfo ${JSON.stringify(f)} ${JSON.stringify(g)}`),{urlConfig:f,clientConfig:g}},showAbout:function(){this.emit('SHOW_ABOUT_LAYER')},showLoginLayer:function(){this.emit('SHOW_LOGIN_LAYER')},getItemH:function(){return c},clearUserInfo:function(m){for(let n in e={},localStorage)(0===n.indexOf('projectattr')||0===n.indexOf('last-up-test-time'))&&localStorage.removeItem(n);localStorage.removeItem('userInfo'),localStorage.removeItem('last-select-project'),this.emit('UPDATA_USER_INFO',e),this.showLoginLayer()},getAutoComplete:function(){return i=JSON.parse(localStorage.getItem('autoComplete'))||[],i},setAutoComplete:function(m){m=(m||'').trim(),i||(i=[]);let n=i.findIndex(o=>{return o===m});m&&-1===n&&-1===m.indexOf('chrome-extension')&&(i.push(m),localStorage.setItem('autoComplete',JSON.stringify(i))),this.emit('UPDATA_AUTOCOMPLETE',i)},getUserInfo:function(){if(e){let m=+new Date;m>e.signatureExpiredTime&&(e={},localStorage.removeItem('userInfo'))}return e},updateUserInfo:function(m){e=m;let n=JSON.stringify(m);localStorage.setItem('userInfo',n),b.info(`windowStores.js updateUserInfo ${n}`),this.emit('UPDATA_USER_INFO',m)},upUserTikcet:function(m,n){e.newticket=m,e.ticketExpiredTime=n,localStorage.setItem('userInfo',JSON.stringify(e)),b.info(`windowStores.js upUserTikcet newticket: ${m} ticketExpiredTime: ${n}`)},delUserTicket:function(){e.ticketExpiredTime=+new Date-100,localStorage.setItem('userInfo',JSON.stringify(e)),b.info(`windowStores.js delUserTicket ticketExpiredTime: ${e.ticketExpiredTime}`)},resize:function(m){c=m-50-37,this.emit('TOGGLE_SHARE_MENUS',c)},focus:function(){this.emit('WINDOW_FOCUS')},blur:function(){this.emit('WINDOW_BLUR')},bodyClick:function(m){this.emit('BODY_CLICK',m)},focusAddressBar:function(m){this.emit('FOCUS_ADDRESSBAR',m)},clearAddressHistory:function(m){i=[],localStorage.setItem('autoComplete',JSON.stringify(i)),this.emit('UPDATA_AUTOCOMPLETE',i,m),m.callBack&&m.callBack()},showSetting:function(){this.emit('SHOW_SETTING')},changeDevtools:function(){this.emit('CHANGE_DEVTOOLS')},getSetting:function(){let m=localStorage.getItem('setting')||'{}';return m&&(m=JSON.parse(m),m.currentProxyHost=m.proxyHost,m.currentProxyPort=m.proxyPort,void 0===m.device&&(void 0===m.os&&(m.os='iOS'),m.device='iOS'===m.os?'iPhone 6':'Nexus 5x')),m},saveSetting:function(m){let n=Object.assign(j,m);m=JSON.stringify(n),b.info(`windowStores.js saveSetting: ${m} `),localStorage.setItem('setting',m)},getCurrentWebviewID:function(){return d},changeUrl:function(m,n){d=n,this.emit('CHANGE_WEBVIEW_URL',m,n)},closeDevtools:function(m){this.emit('CLOSE_WEBVIEW_DEVTOOLS',m)},openDevtools:function(m,n,o){this.emit(`OPEN_WEBVIEW_DEVTOOLS`,m,n,o)},setInfo:function(m){let n=m.device,o=m.os,p=this.getSetting();(p.os!==o||p.device!==n)&&(p.os=o,p.device=n,this.saveSetting(p)),this.emit('SET_WEBVIEW_INFO',m)},appEnterBackground:function(){this.emit('APP_ENTER_BACKGROUND')},appEnterForeground:function(){this.emit('APP_ENTER_FOREGROUND')},clickToolsbar:function(m){this.emit('CLICK_TOOLSBAR',m)},operateMusicPlayer:function(m){this.emit('OPERATE_MUSIC_PLAY',m)},getMusicPlayState:function(m){this.emit('GET_MUSIC_PLAY_STATE',m)},startDebuggee:function(m,n){this.emit('START_WEBVIEW_DEBUGGEE',m,n)},changeWebviewID:function(m){this.emit('WINDOW_CHANGE_WEBVIEW_ID',m)},getWeappError:function(m,n,o){this.emit('WINDOW_GET_WEBAPP_ERROR',m,n,o)},showWeappError:function(m,n){this.emit('WINDOW_SHOW_WEBAPP_ERROR',m,n)},showConfirm:function(m){this.emit('WINDOW_SHOW_CONFIRM',m)},showSimulatorConfirm:function(m){this.emit('WINDOW_SHOW_SIMULATOR_CONFIRM',m)},openProjectFile:function(m){this.emit('OPEN_PROJECT_FILE',m)},getLastShow:function(){return localStorage['last-show']||'debug'},setLastShow:function(m){localStorage['last-show']=m},setLastWinStatus:function(m){localStorage.setItem('last-winStatus',JSON.stringify(m))},getLastWinStatus:function(m){let n=localStorage.getItem('last-winStatus');return n?(n=JSON.parse(n),n.x=-300>n.x?-300:n.x,n.x=1024<n.x?1024:n.x,n.y=0>n.y?0:n.y,n.y=1024<n.y?1024:n.y,n):null},toggleNewFeatureCheckShowStatus:function(m){this.emit('TOGGLE_NEW_FEACHE_CHECK_SHOW_STATUS',m)},showCustomPreview:function(m){this.emit('SHOW_CUSTOM_PREVIEW',m)},showAuthorizeConfirm:function(m){this.emit('WINDOW_SHOW_AUTHORIZE_CONFIRM',m)}});_exports=l}init(),module.exports=_exports;
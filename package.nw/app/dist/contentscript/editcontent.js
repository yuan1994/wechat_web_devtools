'use strict';var portInit=!1,postMessageInit=!1,portMsgQuery=[],postMessageQuery=[],port=chrome.runtime.connect('',{name:`edit`});function postMessageToNW(a){return portInit?void port.postMessage(a):void portMsgQuery.push(a)}function postMessageToWebPage(a){return postMessageInit?void window.postMessage(a,'*'):void postMessageQuery.push(a)}function handleMsg(a){let b=a.command;'SHAKE_HANDS'===b&&(portInit=!0,portMsgQuery.length&&(portMsgQuery.forEach(c=>{postMessageToNW(c)}),portMsgQuery=[]))}function receiveMessageFromPageFrame(a){'backgroundjs'===a.to&&postMessageToNW(a)}port.onMessage.addListener(a=>{let b=a.to;'contentscript'===b?handleMsg(a):'webframe'===b&&postMessageToWebPage(a)}),window.addEventListener('message',a=>{let b=a.data;if('object'==typeof b){let f=b.to,g=b.command;'contentscript'===f&&'SHAKE_HANDS'===g?(postMessageInit=!0,postMessageQuery.length&&(postMessageQuery.forEach(h=>{postMessageToWebPage(h)}),postMessageQuery=[])):'backgroundjs'===f&&receiveMessageFromPageFrame(b)}});